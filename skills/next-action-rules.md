---
name: next-action-rules
description: "Next Action Protocol - コマンド完了後のナビゲーションルール"
license: "MIT"
---

# CTX_next_action_rules

最終更新日時: 2025年12月25日 19:48

# next_action_rules - Next Action Protocol専用ルール

<aside>
📌

**このページについて**

rogos_00〜04の全コマンド完了後に提示するNext Actionのフォーマットとプロンプト例を定義します。

各コマンド実行時は `@_sets/rogos_XX` を通じて自動的に参照されます。

</aside>

---

## 🧭 Next Action Protocolの原則

<aside>
⚙️

**AIへの指示: 必ずコピペ用プロンプトを生成**

1. **各選択肢に実行用プロンプトを付ける**
    - メンションセットを使用（`@_sets/rogos_XX`）
    - 必要なパラメータをプレースホルダで明示
    - **🚨 重要：callout内のプロンプトはコードブロックで囲まず**
        - ❌ コードブロック（`）で囲まない
        - ✅ メンションが機能する形式で出力
2. **推奨選択肢を先に提示**
    - 理由を箇条書きで明示
    - ユーザーが判断できる情報を提供
3. **代替選択肢も必ず提供**
    - 「一度に進めたい」「情報追加」等のニーズに対応
4. **🚨 重要：ユーザーが選択肢を選んでもいきなり実行しない**
    - 選択肢A・Bを選んだ場合でも、即座に実行に進まない
    - 代わりに、コピペ用プロンプトを生成して返す
    - ユーザーが明示的にプロンプトを実行するまで待機
</aside>

<aside>
🎯

**チャット応答でのフォーマットルール**

**🚨 重要：チャット応答ではcalloutを使わない**

- ❌ **NG**: callout内にプロンプトを記述
    - チャットUIでcallout内のテキストが正しく表示されないことがある
    - メンションが消えて見えなくなる場合がある
- ✅ **OK**: calloutを使わず直接記述
    - メンションが正しく機能する
    - コピー&ペーストがスムーズ

**正しい書き方（チャット応答）：**

```
<mention-page url="notion-XX">CMD_aipo_XX</mention-page> を実行してください

Layer: <mention-page url="notion-YY">対象Layer</mention-page>
```

**理由：**

- ページ内ドキュメント用のフォーマット ≠ チャット応答用のフォーマット
- チャットでは最もシンプルな形式が最適
- メンション機能の確実な動作を優先
</aside>

<aside>
⚠️

**注意：選択肢選択後の動作**

ユーザーが「A」「B」などの選択肢を選んだ場合：

- ❌ **いきなり実行してはいけない**
- ✅ **コピペ用プロンプトを生成して返す**
- ✅ **ユーザーが明示的に実行するまで待機**

**理由：**

- ユーザーがプロンプトを確認・編集できるようにする
- 意図しない実行を防ぐ
- ユーザーのコントロール感を維持
</aside>

---

---

## 📝 rogos_01完了後のNext Action

**基本フォーマット:**

<aside>
💡

🔜 Next Step

**次のアクションを選択してください：**

（選択肢を選んだとしても、いきなりは進まず、コピペできるプロンプトを作成します）

（選択肢を選んだとしても、いきなりは進まず、コピペできるプロンプトを作成します）

| 選択肢 | アクション | 説明 |
| --- | --- | --- |
| **A** | [CMD_aipo_02_sense_and_focus](https://www.notion.so/CMD_aipo_02_sense_and_focus-e67af401dd26413da1db39e9820a1e8b?pvs=21) を実行 | タスク分解を開始（推奨） |
| **B** | Context情報を追加修正 | 追加の制約条件や参考資料があれば共有 |

💡 **推奨: A（rogos_02_sense_and_focus）**

理由:

- Layer構造とContextが整いました
- SubLayerとタスクに分解できます
- 全体の作業量と依存関係が見えます
</aside>

### 📋 選択肢Aのプロンプト（コピペ用）

---

<aside>
💡

[CMD_aipo_02_sense_and_focus](https://www.notion.so/CMD_aipo_02_sense_and_focus-e67af401dd26413da1db39e9820a1e8b?pvs=21)   を実行してください

Layer: @[対象Layerページ]

</aside>

---

## 📝 rogos_02完了後のNext Action

**基本フォーマット:**

<aside>
💡

🔜 Next Step

**次のアクションを選択してください：**

（選択肢を選んだとしても、いきなりは進まず、コピペできるプロンプトを作成します）

（選択肢を選んだとしても、いきなりは進まず、コピペできるプロンプトを作成します）

| 選択肢 | アクション | 説明 |
| --- | --- | --- |
| **A** | [CMD_aipo_03_discover](https://www.notion.so/CMD_aipo_03_discover-f438f6d985a149e3bdd36cd6cf180d97?pvs=21) を実行 | コマンドページを生成（推奨） |
| **B** | tasks.yamlを修正してから実行 | タスク定義を調整したい場合 |

💡 **推奨: A（rogos_03_discover）**

理由:

- tasks.yamlが完成しました
- 各タスクの実行用コマンドページを自動生成できます
- 次のrogos_04でタスク実行が開始できます
</aside>

### 📋 選択肢Aのプロンプト（コピペ用）

---

<aside>
💡

[CMD_aipo_03_discover](https://www.notion.so/CMD_aipo_03_discover-f438f6d985a149e3bdd36cd6cf180d97?pvs=21)   を実行してください

Layer: @[対象Layerページ]

</aside>

---

---

## 📝 rogos_03完了後のNext Action

**基本フォーマット:**

<aside>
💡

🔜 Next Step

**次のアクションを選択してください：**

（選択肢を選んだとしても、いきなりは進まず、コピペできるプロンプトを作成します）

（選択肢を選んだとしても、いきなりは進まず、コピペできるプロンプトを作成します）

| 選択肢 | アクション | 説明 |
| --- | --- | --- |
| **A** | [CMD_aipo_04_deliver](https://www.notion.so/CMD_aipo_04_deliver-4a7d3a9ff65f4b22968540d7c979b5b5?pvs=21) で最初のタスク実行 | 優先度P0のタスクから開始（推奨） |
| **B** | 全タスク一覧を確認 | Commands/フォルダ内のコマンドを確認 |

💡 **推奨: A（rogos_04_deliver）**

理由:

- 全てのコマンドページが生成されました
- 実行準備が整っています
- P0タスクから順次実行していきましょう
</aside>

### 📋 選択肢Aのプロンプト（コピペ用）

---

<aside>
💡

[CMD_aipo_04_deliver](https://www.notion.so/CMD_aipo_04_deliver-4a7d3a9ff65f4b22968540d7c979b5b5?pvs=21)  を実行してください

Layer: @[対象Layerページ]

Task: [最初のタスクID（例：T1.1）]

</aside>

---

## 📝 rogos_04完了後のNext Action

**基本フォーマット:**

<aside>
💡

🔜 Next Step

**次のアクションを選択してください：**

（選択肢を選んだとしても、いきなりは進まず、コピペできるプロンプトを作成します）

（選択肢を選んだとしても、いきなりは進まず、コピペできるプロンプトを作成します）

| 選択肢 | アクション | 説明 |
| --- | --- | --- |
| **A** | 次のタスクを実行 | [次タスクID] を実行（推奨） |
| **B** | 親Layerに戻る | 他のSubLayerの状況を確認 |
| **C** | セッションを終了 | 作業を一時停止 |

💡 **推奨: A（次タスク実行）**

理由:

- [現タスクID] が完了しました
- [次タスクID] の依存関係が解消されています
- 連続実行で効率的に進められます
</aside>

### 📋 選択肢Aのプロンプト（コピペ用）

---

<aside>
💡

[CMD_aipo_04_deliver](https://www.notion.so/CMD_aipo_04_deliver-4a7d3a9ff65f4b22968540d7c979b5b5?pvs=21)  を実行してください

Layer: @[対象Layerページ]

Task: [次タスクID]

</aside>

---

**⚠️ 注意: 残タスク確認を必ず実行**

- rogos_04完了後は必ず親Layerの残タスクを確認すること
- 詳細は `@session_rules` の「セッション完了前チェック」を参照

---

**作成日**: 2025-12-07

**ステータス**: 実装完了