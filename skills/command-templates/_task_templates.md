# _task_templates

最終更新日時: 2025年12月6日 19:43

# task_templates - タスク種類別実行パターン

<aside>
🚨

## 🔴 最重要原則：全てのタスクは「動くDB/システム」を生み出す

**ROGOSの全てのタスクは、最終的に「実際に動くDatabase/システム」を生み出さなければならない。**

```yaml
task_output_rule:
  mandatory:
    - "タスク完了時に、少なくとも1つのDatabaseが存在すること"
    - "または、既存DBに機能追加（ビュー/プロパティ/データ）されていること"
    - "ガイド/設計書は、DBの付属ドキュメントとしてのみ許可"
  
  prohibited:
    - "ガイドだけ作って完了"
    - "設計書だけ作って完了"
    - "DBスキーマ定義だけ書いて実際のDB作成なし"
  
  check_before_complete:
    question: "このタスクで実際のDatabaseは作成/更新されたか？"
    if_no: "完了とせず、DB作成を実行する"
```

**⚠️ 設計書やスキーマ定義を書いただけでは「完了」にならない。**

**実際のDatabaseが存在して初めて「完了」となる。**

</aside>

---

> **L001/L002の反省を踏まえ、「ドキュメント集」ではなく「動くシステム」を作るためのガイド**
> 

> 
> 

> 「AIが全文生成して終わり」を防ぎ、**実際に動くDB**を生み出すためのルール
> 

---

## 📁 Documentsフォルダ：コンテキスト整理の標準化

<aside>
📁

**rogos_02_decompose 実行時に生成されるフォルダ**

タスク分解（decompose）のInit時に収集したコンテキストを整理し、構造化されたドキュメントとして保存します。

**目的**

- **コンテキストの整理**: 外部調査、戦略分析、競合情報などを構造化
- **タスク実行の参照資料**: rogos_05_execute 時に即座に参照可能
- **将来の再利用素材**: 型化・ナレッジ化のための素材蓄積

**典型的な内容**

- 戦略分析（Palantir FDEモデル等の外部調査）
- 競合調査（LayerX等のベンチマーク）
- 既存アセット整理（社内の関連リソース）
- フレームワーク整理（適用する理論・モデル）

**生成タイミング**: rogos_02_decompose の Phase 1（Auto-Research）完了後

</aside>

---

## ⚠️ なぜこれが必要か（L001/L002の反省）

<aside>
🚨

**L001/L002で起きた問題**

- AIが「ガイド作成」タスクを一気に全文生成
- 「DBスキーマ定義」を書いたが実際のDBは作成されなかった
- 人間のレビュー・検証なしに「完了」扱い
- 結果：「業務基盤」ではなく「ドキュメント集」ができた
- **21本の成果物中、実際のDBは1本だけだった**
</aside>

---

## 📋 タスク種類一覧

| 種類 | 説明 | アンチパターン |
| --- | --- | --- |
| **document_creation** | ガイド、テンプレート、ルール定義 | AIが全文生成して終わり |
| **process_implementation** | ワークフロー、自動化、DB設計 | 手順書を書いて終わり |
| **validation** | ヒアリング、テスト、レビュー | チェックリストを作って終わり |
| **planning** | ロードマップ、優先度決定 | 表を作って終わり |
| 種類 | 説明 | **必須出力** |
| **🔴 db_implementation** | **DB作成・実装（最優先）** | **Database** |
| **document_creation** | ガイド、テンプレート | Page + **関連DB** |
| **process_implementation** | ワークフロー、自動化 | **DB + ビュー** |
| **validation** | ヒアリング、テスト | 検証結果 + **DB更新** |
| **planning** | ロードマップ、優先度 | 計画 + **管理DB** |
| Phase | Action | Output |
| **1. design** | DBスキーマを設計 | 設計案 |
| **2. create_db** | **実際にDBを作成** | **Database** |
| **3. add_views** | 必要なビューを追加 | **Views** |
| **4. seed_data** | 初期データを投入 | **Data** |
| **5. document** | 使い方ガイドを追加 | Page（付属） |

---

## 📝 Type 1: document_creation（ドキュメント作成）

### 対象

- ガイド、マニュアル
- テンプレート
- ルール定義、ポリシー

### ❌ アンチパターン

```
AIが全文生成 → 「完了」 → 誰も読まない → 使われない
```

### ✅ 理想フロー

| Phase | Action | Output | Human |
| --- | --- | --- | --- |
| **1. skeleton** | AIが骨格（目次・主要セクション）を生成 | 構成案 | ✅ 確認必須 |
| **2. draft** | AIが各セクションのドラフトを生成 | ドラフト版 | ✅ 具体例追加 |
| **3. review** | 関係者がレビュー | コメント | ✅ **人間が実施** |
| **4. finalize** | AIがフィードバック反映 | 確定版 | ✅ 最終確認 |

### Done条件

```yaml
done_when:
  - "骨格が人間に承認されている"
  - "具体例・チーム固有の慣習が追加されている"
  - "関係者のレビューコメントが反映されている"
  - "関係者の承認がある"
```

### 呼び出し例

```
@rogos_commands @task_templates を参照して
@rogos_05_execute を実行してください

Task: T001_Sprint Planningテンプレート作成
Type: document_creation
```

---

## 🔧 Type 2: process_implementation（プロセス構築）

### 対象

- ワークフロー設計
- DB設計・構築
- 自動化ルール

### ❌ アンチパターン

```
手順書を書く → 「完了」 → 実装されない → 誰も使わない
```

### ✅ 理想フロー

| Phase | Action | Output | Human |
| --- | --- | --- | --- |
| **1. current_state** | 現状のAs-Isを可視化 | 現状フロー図 | ✅ 実態確認 |
| **2. design** | To-Beを設計 | 設計案 | ✅ 承認必須 |
| **3. implement** | 実際にNotionに実装 | DB/ビュー/自動化 | ✅ 確認 |
| **4. pilot** | 小さく試す | パイロット結果 | ✅ **人間が実施** |
| **5. rollout** | 全体展開 | 運用開始 | ✅ 判断 |

### Done条件

```yaml
done_when:
  - "現状フローが関係者に確認されている"
  - "設計が承認されている"
  - "実際にNotionで動作している"
  - "1回以上パイロット運用で使われた"
  - "全体展開の判断がされている"
```

---

## ✅ Type 3: validation（検証・評価）

### 対象

- ヒアリング
- テスト実施
- レビュー

### ❌ アンチパターン

```
チェックリスト作成 → 「完了」 → 実際の検証なし
```

### ✅ 理想フロー

| Phase | Action | Output | Human |
| --- | --- | --- | --- |
| **1. criteria** | 評価基準を定義 | 評価シート | ✅ 確認 |
| **2. execute** | 実際に検証を実施 | 検証結果 | ✅ **人間が実施** |
| **3. analyze** | 結果を分析 | 分析レポート | - |
| **4. action** | 改善アクションを特定 | 改善計画 | ✅ 承認 |

### Done条件

```yaml
done_when:
  - "評価基準が明確である"
  - "検証が実際に実施された"
  - "結果が分析されている"
  - "改善アクションが特定・承認されている"
```

---

## 📅 Type 4: planning（計画・設計）

### 対象

- ロードマップ策定
- 優先度決定
- スコープ定義

### ❌ アンチパターン

```
AIが表を作成 → 「完了」 → 関係者の合意なし
```

### ✅ 理想フロー

| Phase | Action | Output | Human |
| --- | --- | --- | --- |
| **1. gather** | 関係者の意見を収集 | インプット一覧 | ✅ 情報提供 |
| **2. draft** | 計画案を作成 | ドラフト計画 | - |
| **3. align** | 関係者と合意形成 | 合意内容 | ✅ **人間が実施** |
| **4. commit** | コミットメントを確定 | 確定計画 | ✅ 承認 |

### Done条件

```yaml
done_when:
  - "関係者の意見が収集されている"
  - "計画案が作成されている"
  - "関係者が合意している"
  - "リソース・スケジュールがコミットされている"
```

---

## ⚖️ 基本原則（全タスク種類共通）

<aside>
📌

**原則1: HITL情報の拘束力**

HITLまたはcontext.yamlで人間が明示的に指定した情報源は「**要件**」として扱う。

ワークスペース検索で見つかった類似情報より**常に優先**する。

**原則2: 出力の検証**

タスク完了前に、以下を確認する：

- 指定されたインプットを**実際に使用したか**
- 出力が指定されたインプットの**規模・範囲と整合しているか**

不整合がある場合は完了とせず、ユーザーに報告する。

**原則3: 出力エンティティタイプの明確化**

Notionで成果物を作成する際、以下を明確に区別する：

| 要件 | 正しいエンティティ | 間違いの例 |
| --- | --- | --- |
| 「Kanbanビューを作成」 | **Database** + Boardビュー | ページに説明文 |
| 「Timelineビューを作成」 | **Database** + Timelineビュー | ページに説明文 |
| 「進捗管理DBを作成」 | **Database** + 適切なプロパティ | ページにテーブル |
| 「テンプレートを作成」 | **Page**（テンプレート形式） | 説明だけのページ |
| 「ガイドを作成」 | **Page**（本文あり） | OK |

```yaml
output_entity_check:
  before_create:
    - "この成果物はDBが必要か、ページで十分か？"
    - "ビューが必要な場合、実際にDBを作成しているか？"
    - "DBを作る場合、必要なプロパティは何か？"
  
  prohibited:
    - "Kanbanビュー" → ページで説明文を書く
    - "Timelineビュー" → ページで説明文を書く
    - "進捗管理" → ページ内のテーブルで代用
  
  required:
    - "ビュー作成" → 必ずDatabaseを作成
    - "進捗管理" → 必ずDatabaseを作成
    - "データ管理" → 必ずDatabaseを作成
```

**原則4: DB作成時の必須チェック**

データベースを作成する場合、以下を必ず確認：

1. **プロパティ定義** - 必要なプロパティが全て設定されているか
2. **ビュー設定** - 要件に合ったビュー（Table/Board/Timeline等）が作成されているか
3. **初期データ** - 必要な初期データが投入されているか

不整合がある場合は完了とせず、ユーザーに報告する。

</aside>

---

## 🤖 AIへの指示

<aside>
🤖

**タスク実行時のAI動作**

1. タスクの種類を判定（document_creation / process_implementation / validation / planning）
2. 該当する理想フローを適用
3. **各Phaseで人間の確認を求める**
4. 「human_checkpoint: true」のPhaseでは必ず一時停止
5. Done条件をすべて満たすまで「完了」としない
6. **原則1・2を常に適用**：HITL情報を優先し、出力を検証する

**Phase表示フォーマット（必須）**

各Phase開始時に以下のフォーマットで出力すること：

```jsx
📍 Phase 2/4: draft
━━━━━━━━━━━━━━━━━━━━
[作業内容をここに記載]
```

Phase完了時：

```jsx
✅ Phase 2 完了

👤 Human checkpoint
[確認してほしい内容を明記]

確認できたら「OK」と返信してください。
```

**一気に進めない**：Human checkpointでは必ず一時停止し、ユーザーの「OK」を待つこと。

</aside>

---

**作成日**: 2025-11-28

**更新日**: 2025-11-28

**ステータス**: Ready（Phase表示フォーマット追加）