# CMD_tsk_タスク抽出

最終更新日時: 2025年12月25日 9:06

## 📌 コマンド概要

**目的**: 任意のNotionページからアクションアイテム・タスクを抽出し、今日のタスクリストに追加

**用途**: 議事録、依頼対応ドキュメント、プロジェクト計画など、あらゆるページからタスク管理を自動化

**実行時間**: 30秒以内

---

## 📥 Input

### 必須項目

- **対象ページ** (必須): タスクを抽出したいNotionページのURL、または現在開いているページを自動認識

### オプション項目

- **担当者フィルター** (オプション): 自分のタスクのみ抽出するか、全員分を表示するか
    - デフォルト: 自分のタスクのみ
- **優先度判定** (オプション): 自動で優先度を判定するか
    - デフォルト: 自動判定ON

### 入力例

```jsx
@CMD_タスク抽出 を実行してください

対象ページ: [このページを@mention]
```

または：

```jsx
このページから私のタスクを抽出してください
```

(現在開いているページを自動認識)

---

## 📤 Output

### 作成されるページ構造

```jsx
Flow/
└── 202512/
    └── 2025-12-10/
        └── 📋 今日のタスク - 2025-12-10
            ├── (既存のタスク)
            └── ## 📝 [ページ名]からのタスク (追記)
                - [ ] タスク1 (@担当者) - 期限: YYYY-MM-DD
                - [ ] タスク2 (@担当者) - 期限: YYYY-MM-DD
```

### 出力内容

- **自分に割り当てられたアクションアイテム**を抽出
- 優先度を自動判定（緊急・重要度）
- 期限があれば明記
- 元のページへのリンクを付与

---

## 🔧 実行方法

Notion AIチャットで以下のように実行してください：

```jsx
@CMD_タスク抽出 を実行してください

対象ページ: [@ページをmention]
```

または：

```jsx
このページから私のタスクを抽出してください
```

---

## 📋 処理ロジック

### ステップ0: 今日のタスクページの読み込みと構造分析 (5秒) ⭐NEW

**重要**: タスクを追加する前に、必ず既存のタスクページを読み込んで構造を理解する

1. Flow/YYYYMM/YYYY-MM-DD/📋 今日のタスク - YYYY-MM-DD を検索・読み込み
2. ページが存在しない場合:
    - [CMD_日次タスク作成](https://www.notion.so/CMD_-2c4b133701be81fe9704dbf4c0928383?pvs=21) を自動実行
    - 作成されたページを読み込み
3. **既存の構造を分析**：
    - 🔴 緊急・重要セクションの有無と位置を確認
    - 🟡 重要・非緊急セクションの有無と位置を確認
    - 🟢 その他セクションの有無と位置を確認
    - 既存タスクの記載フォーマットを確認
    - セクション間の区切り（統計情報、イベント情報など）を確認
4. **マージ戦略を決定**：
    - 既存セクションが存在する → 各セクション内に統合
    - 既存セクションが空または存在しない → 新規追加

### ステップ1: 対象ページの解析 (10秒)

1. 指定されたNotionページを読み込み
2. ページ全体から以下を抽出：
    - **チェックボックス形式のタスク**（`- [ ]`）
    - **「アクションアイテム」「TODO」「Next Actions」などのセクション**
    - **「決定事項」「今後の予定」などのセクション**
    - **期限・担当者が記載されている箇条書き**
    - **絵文字マーカー付きタスク**（🔴、🟡、🟢など）
3. 各タスクから以下の情報を抽出：
    - タスク内容
    - 担当者（@mention、または「miyatti」「宮田」などのテキスト）
    - 期限（日付表記、「今週中」「年内」などの相対表記）
    - 優先度のヒント（「緊急」「重要」「至急」などのキーワード、絵文字マーカー）
    - 元の記載場所（セクション名）

### ステップ2: 自分のタスクをフィルタリング (5秒)

1. 現在のユーザー（miyatti）が担当者として記載されているタスクを抽出
2. 担当者が明記されていない場合：
    - 文脈から判断（依頼を受けている、責任者として記載されている等）
    - 不明な場合は候補として提示: 「これはあなたのタスクですか？」
3. 優先度を判定：
    - **🔴 緊急・重要**:
        - 期限が今日または明日
        - 「至急」「緊急」「ASAP」などのキーワード
        - 🔴絵文字マーカー
    - **🟡 重要・非緊急**:
        - 期限が今週以内
        - 「重要」「優先」キーワード
        - 🟡絵文字マーカー
    - **🟢 その他**:
        - その他のタスク
        - 🟢絵文字マーカー

### ステップ3: 既存セクションへのマージ (10秒) ⭐UPDATED

**重要**: 新しいセクションを作らず、既存のセクションに統合する

1. **🔴 緊急・重要セクション**にタスクがある場合：
    - セクション内の最後のタスクを特定
    - その直後に新しいタスクを追加
    - フォーマット例：
    
    ```markdown
    - [ ] **kanさんに確認 - 経営観点での目標を共有いただく**
      - 元: <mention-page>kanさん依頼対応_PF計画FDE統合版</mention-page> > アクションプラン > 今日
      - 依頼方法: Slackで簡潔に依頼...
    ```
    
2. **🟡 重要・非緊急セクション**にタスクがある場合：
    - 同様に既存タスクの直後に追加
3. **🟢 その他セクション**にタスクがある場合：
    - 同様に既存タスクの直後に追加
4. **セクションが空または「*(なし)*」の場合**：
    - 「*(なし)*」を削除
    - タスクを追加
5. **各タスクに元のページ情報を付記**：
    - 元のページへのリンク
    - どのセクションから抽出したか
    - その他の補足情報（期限、依頼方法など）

**マージ例**：

```markdown
## 🔴 緊急・重要

- [ ] **既存のタスク1**
  - 元: 議事録「〇〇」
  - 内容: ...

- [ ] **kanさんに確認 - 経営観点での目標を共有いただく**
  - 元: <mention-page>kanさん依頼対応_PF計画FDE統合版</mention-page> > アクションプラン
  - 依頼方法: Slackで簡潔に依頼...

- [ ] **既存ロードマップの棚卸し**
  - 元: <mention-page>kanさん依頼対応_PF計画FDE統合版</mention-page> > アクションプラン
  - 対象: 中長期ロードマップ v1.0
```

```

```

### ステップ4: 完了メッセージ (5秒)

```jsx
✅ ページからタスクを抽出しました！

抽出場所：
📋 Flow/202512/2025-12-10/今日のタスク - 2025-12-10

タスク数：
🔴 緊急・重要: 2件
🟡 重要・非緊急: 3件
🟢 その他: 1件

元のページ：
📋 kanさん依頼対応_PF計画FDE統合版

📌 次のステップ：
- タスクを確認して優先順位を調整
- 期限を確認してカレンダーに反映
- 不明点があれば元のページで確認
```

---

## ⚠️ 注意事項

### エラーハンドリング

1. **対象ページが指定されていない場合**
    - エラーメッセージ: 「対象ページを指定してください。現在のページを使用する場合は「このページ」と入力してください。」
2. **タスクが見つからない場合**
    - 警告メッセージ: 「タスクが見つかりませんでした。ページにチェックボックスやアクションアイテムがあるか確認してください。」
3. **自分のタスクが0件の場合**
    - メッセージ: 「あなたに割り当てられたタスクは見つかりませんでした。他のメンバーのタスクを確認しますか？」
4. **今日のタスクページが存在しない場合**
    - 自動的に [CMD_日次タスク作成](https://www.notion.so/CMD_-2c4b133701be81fe9704dbf4c0928383?pvs=21) を実行して作成

### 実行時間

- 目標: 30秒以内
- ステップ1：10秒
- ステップ2：5秒
- ステップ3：10秒
- ステップ4：5秒

### 担当者の識別

- **@mention形式**: @miyatti
- **名前のテキスト**: 「miyatti」「miyattiさん」「宮田さん」
- **役職/チーム**: 「Product担当」などから推測
- **文脈判断**: 「私が〜」「自分が〜」などの一人称表現

---

## 💡 活用例

### 例1: 議事録からのタスク抽出（従来の使い方）

```jsx
// ミーティング終了後すぐに実行
この議事録から私のタスクを抽出してください

→ アクションアイテムセクションからタスク抽出
→ 今日のタスクリストに自動追加
→ 優先度順に整理済み
```

### 例2: 依頼対応ドキュメントからのタスク抽出（新機能）

```jsx
// kanさんからの依頼を受けた後
@CMD_タスク抽出 を実行してください

対象ページ: @kanさん依頼対応_PF計画FDE統合版

→ アクションプランセクションから全タスク抽出
→ 期限付きタスクを優先度別に整理
→ 今日やるべきことが明確に
```

**抽出例**：

- 🔴 今日: kanさんに確認 - 経営観点での目標
- 🔴 今日: 既存ロードマップの棚卸し
- 🟡 今週: FDE統合版ロードマップ ドラフトv0.1 作成
- 🟡 今週: Phase別FDE体制表の作成

### 例3: プロジェクト計画からのタスク抽出

```jsx
// プロジェクト計画を立てた後
このプロジェクト計画から私のタスクを抽出してください

→ マイルストーン、実装計画からタスク抽出
→ Phase別のタスクを時系列で整理
→ 今週やるべきことを明確化
```

### 例4: 複数ページからの一括抽出

```jsx
// 週次レビュー時
@CMD_タスク抽出 を実行してください

対象ページ: 
@月曜MTG議事録
@水曜MTG議事録  
@kanさん依頼対応ドキュメント
@プロジェクトA計画

→ 複数ページから一括抽出
→ 重複を除外して整理
→ 週の全タスクを漏れなく把握
```

### 例5: 他メンバーのタスク確認

```jsx
// 担当者フィルターをオフに
このページから全員分のタスクを表示してください

→ チーム全体のタスクを把握
→ 進捗確認やフォローアップに活用
→ リソース配分の最適化
```

---

## 🎯 対応可能なページタイプ

### ✅ 抽出対応

- **議事録**: アクションアイテム、決定事項
- **依頼対応ドキュメント**: アクションプラン、必要なアクション
- **プロジェクト計画**: マイルストーン、実装タスク
- **ロードマップ**: Phase別のアクション
- **提案書**: Next Steps、実施事項
- **レビュー文書**: 改善アクション、フォローアップ
- **日報・週報**: 今後の予定、TODO
- **戦略文書**: 実行アクション

### 🔍 抽出パターン

1. **チェックボックス形式**: `- [ ] タスク内容`
2. **セクション形式**:
    - アクションアイテム
    - TODO / Next Actions
    - 決定事項
    - 今後の予定
    - 実施事項
3. **箇条書き形式**: 期限・担当者付きの箇条書き
4. **絵文字マーカー**: 🔴、🟡、🟢などの優先度マーカー
5. **テーブル形式**: タスク管理テーブル

---

## 🔗 関連リソース

- [CMD_日次タスク作成](https://www.notion.so/CMD_-2c4b133701be81fe9704dbf4c0928383?pvs=21)（連携コマンド）
- [CMD_com_Slack依頼分析＆タスク化](https://www.notion.so/CMD_com_Slack-0d3c33e38d6247c6bdc495f06cb1cb0d?pvs=21)（依頼対応フロー）
- [CMD_議事録生成](https://www.notion.so/CMD_-dce0c0895fcb4e9d976f60dbe4c94acd?pvs=21)（議事録作成）
- [CTX_abstract_mode_rules](../../abstract-mode.md)

---

## 🧪 テスト結果

### テスト1: 議事録からの抽出

- ステータス: ⏳ 未実施
- タスク数: 5件（自分: 2件）
- 実行時間: -
- 結果: -

### テスト2: 依頼対応ドキュメントからの抽出

- ステータス: ⏳ 未実施
- 対象: kanさん依頼対応_PF計画FDE統合版
- 期待されるタスク数: 10件以上
- 実行時間: -
- 結果: -

### テスト3: タスクなし

- ステータス: ⏳ 未実施
- アクションアイテムが0件の場合
- 実行時間: -
- 結果: -

### テスト4: 今日のタスクページが存在しない

- ステータス: ⏳ 未実施
- CMD_日次タスク作成を自動実行
- 実行時間: -
- 結果: -

---

**作成日**: 2025-12-10

**作成者**: miyatti

**最終更新**: 2025-12-10（汎用化対応）

**ステータス**: 仕様完成・実装待ち